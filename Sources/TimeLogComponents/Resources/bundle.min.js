!function(){"use strict";const t={};function n(n,e){return t[n]||(t[n]=[]),t[n].push(e),()=>{t[n]=t[n].filter((t=>t!=e))}}function e(t,n,e){2==arguments.length&&"function"==typeof n&&(e=n,n=null),function(t,n){if(n){const e=r();t.callbackID=e,o[e]=n}window.webkit.messageHandlers.timeLineBridge.postMessage(JSON.stringify({...t,data:t.data?JSON.stringify(t.data):null}))}({eventName:t,data:n},e)}const o={};const r=function(){const t=()=>`${Date.now()}${Math.random().toString(36).substring(2)}`,n=new Set;return()=>{n.size>=500&&n.clear();let e=t();for(;n.has(e);)t=t();return n.add(e),e}}(),i={};function a(t,n){return i[t]=n,()=>{i[t]===n&&(i[t]=null)}}window.timeLineBridge={addEventListener:n,addEventHandler:a,callNative:e,triggerEvent:function(t,n){e(t,n)},_handleMessageFromNative:function(n){const e=JSON.parse(n);if(e.callbackID){const t=o[e.callbackID];t&&t(e.data)}else{const n=t[e.eventName];n&&n.length>0&&n.forEach((t=>{t(e.data)}))}},_handleEventFromNative:function(t){const{eventName:n,data:e}=JSON.parse(t)||{};if(n&&i[n]){const t=i[n](e||null);return null==t?null:JSON.stringify(t)}return null}};var l="object"==typeof global&&global&&global.Object===Object&&global,c="object"==typeof self&&self&&self.Object===Object&&self,u=l||c||Function("return this")(),s=u.Symbol,f=Object.prototype,d=f.hasOwnProperty,v=f.toString,g=s?s.toStringTag:void 0;var p=Object.prototype.toString;var b="[object Null]",m="[object Undefined]",h=s?s.toStringTag:void 0;function y(t){return null==t?void 0===t?m:b:h&&h in Object(t)?function(t){var n=d.call(t,g),e=t[g];try{t[g]=void 0;var o=!0}catch(t){}var r=v.call(t);return o&&(n?t[g]=e:delete t[g]),r}(t):function(t){return p.call(t)}(t)}var O="[object Symbol]";var w=/\s/;var T=/^\s+/;function N(t){return t?t.slice(0,function(t){for(var n=t.length;n--&&w.test(t.charAt(n)););return n}(t)+1).replace(T,""):t}function S(t){var n=typeof t;return null!=t&&("object"==n||"function"==n)}var j=NaN,B=/^[-+]0x[0-9a-f]+$/i,x=/^0b[01]+$/i,E=/^0o[0-7]+$/i,k=parseInt;function I(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return null!=t&&"object"==typeof t}(t)&&y(t)==O}(t))return j;if(S(t)){var n="function"==typeof t.valueOf?t.valueOf():t;t=S(n)?n+"":n}if("string"!=typeof t)return 0===t?t:+t;t=N(t);var e=x.test(t);return e||E.test(t)?k(t.slice(2),e?2:8):B.test(t)?j:+t}var J=function(){return u.Date.now()},L="Expected a function",C=Math.max,D=Math.min;function M(t,n,e){var o,r,i,a,l,c,u=0,s=!1,f=!1,d=!0;if("function"!=typeof t)throw new TypeError(L);function v(n){var e=o,i=r;return o=r=void 0,u=n,a=t.apply(i,e)}function g(t){var e=t-c;return void 0===c||e>=n||e<0||f&&t-u>=i}function p(){var t=J();if(g(t))return b(t);l=setTimeout(p,function(t){var e=n-(t-c);return f?D(e,i-(t-u)):e}(t))}function b(t){return l=void 0,d&&o?v(t):(o=r=void 0,a)}function m(){var t=J(),e=g(t);if(o=arguments,r=this,c=t,e){if(void 0===l)return function(t){return u=t,l=setTimeout(p,n),s?v(t):a}(c);if(f)return clearTimeout(l),l=setTimeout(p,n),v(c)}return void 0===l&&(l=setTimeout(p,n)),a}return n=I(n)||0,S(e)&&(s=!!e.leading,i=(f="maxWait"in e)?C(I(e.maxWait)||0,n):i,d="trailing"in e?!!e.trailing:d),m.cancel=function(){void 0!==l&&clearTimeout(l),u=0,o=c=r=l=void 0},m.flush=function(){return void 0===l?a:b(J())},m}const $={modules:{toolbar:!1},placeholder:"备注",theme:"snow",readOnly:{readOnly:!1,...window.tl_editor_config||{}}.readOnly},F=new Quill("#editor",$);function _(){const t=F.getSelection();return null==t?{}:F.getFormat(t)}function W(t){const n=_(),e=parseInt(n.indent||0,10);t*="rtl"===n.direction?-1:1,F.format("indent",e+t)}n("toolbar.boldButtonTapped",(()=>{const t=(n="bold",null!=_()[n]);var n;F.format("bold",!t)})),n("toolbar.numberListButtonTapped",(()=>{const t=_();F.format("list","ordered"!==t.list&&"ordered")})),n("toolbar.dashListButtonTapped",(()=>{const t=_();F.format("list","bullet"!==t.list&&"bullet")})),n("toolbar.checkBoxListButtonTapped",(()=>{const t=_();"checked"===t.list||"unchecked"===t.list?F.format("list",!1):F.format("list","unchecked")})),n("toolbar.increaseIndentButtonTapped",(()=>{W(1)})),n("toolbar.decreaseIndentButtonTapped",(()=>{W(-1)})),n("toolbar.blurButtonTapped",(()=>{F.blur()})),a("editor.fetchContent",(()=>F.getContents())),n("editor.setContent",(t=>{F.setContents(JSON.parse(t),"api")}));const H=function(t,n,e){var o=!0,r=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return S(e)&&(o="leading"in e?!!e.leading:o,r="trailing"in e?!!e.trailing:r),M(t,n,{leading:o,maxWait:n,trailing:r})}((function(t,n){e("editor.contentChange",{content:content,lines:n})}),300,{leading:!1});F.on("text-change",((t,n,e)=>{"user"==e&&H(JSON.stringify(F.getContents()),F.getLines().length)}))}();
